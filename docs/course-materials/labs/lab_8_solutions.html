<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SDS 192 - Querying a MySQL database</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../course-materials/website//images/192.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">SDS 192</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../course-materials/website/Resources.html" rel="" target="">
 <span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://mdsr-book.github.io/mdsr3e/" rel="" target=""><i class="bi bi-book" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://moderndive.com/C-appendixC.html" rel="" target="">
 <span class="menu-text">T &amp; T</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.slack.com" rel="" target=""><i class="bi bi-slack" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://rstudio.smith.edu/auth-sign-in?appUri=%2F" rel="" target="">
 <span class="menu-text">R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://moodle.smith.edu/" rel="" target="">
 <span class="menu-text">m</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://classroom.github.com/classrooms/144164606-sds-192-f23-sections-02-03" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../.././course-materials/syllabus/syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../course-materials/website/schwab.html" rel="" target="">
 <span class="menu-text">Schwab</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Querying a MySQL database</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This lab was originally created by Profs Ben Baumer and Jordan Crouser. I’ve edited it slightly.</p>
<p><a href="https://en.wikipedia.org/wiki/SQL">SQL</a> is a longstanding database querying language. It is a loosely-implemented standard. We will be using <a href="https://en.wikipedia.org/wiki/MySQL">MySQL</a>.</p>
<p>To facilitate our connection to the MySQL database server, we will need to install the <code>RMySQL</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do NOT install RMySQL if you are on the RStudio Server</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"RMySQL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Goal</strong>: by the end of this lab, you will be able to write basic <code>SELECT</code> queries in SQL and retrieve the results into R.</p>
<section id="connecting-to-mysql" class="level2">
<h2 class="anchored" data-anchor-id="connecting-to-mysql">Connecting to MySQL</h2>
<p>The data we will be using is stored on a server in Bass Hall. It’s called <code>scidb.smith.edu</code>. We can connect through the <code>dbConnect()</code> function provided by the <code>DBI</code> package (which is loaded automatically when you load <code>RMySQL</code>). You will also need the <code>RMySQL</code> package installed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RMySQL)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>db <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MySQL</span>(),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">host =</span> <span class="st">"scidb.smith.edu"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">user =</span> <span class="st">"sds192"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">password =</span> <span class="st">"DSismfc@S"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbname =</span> <span class="st">"imdb"</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">connection=</span> <span class="st">'db'</span>, <span class="at">max.print =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This chunk of code will allow you to connect to <code>scidb</code>. Note that this creates a database connection object named <code>db</code>, which has the class <code>MySQLConnection</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(db)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MySQLConnection"
attr(,"package")
[1] "RMySQL"</code></pre>
</div>
</div>
<p>Also, we set the <code>connection</code> parameter for all future chunks in this R Markdown file. Note also that the <code>max.print</code> argument sets the maximum number of results printed by each query.</p>
<p>Each of the following chunks makes use of the SQL engine functionality in <code>knitr</code>. You may want to <a href="https://bookdown.org/yihui/rmarkdown/language-engines.html#sql">read about this</a>. Each of the following chunks is an <code>sql</code> chunk – as opposed to an <code>r</code> chunk!</p>
<p>To retrieve the results from a query in R, use the <code>dbGetQuery()</code> function from the <code>DBI</code> package (which is automatically loaded when you load <code>RMySQL</code>). Its first argument is a database connection object, and the second argument is an SQL query as a character vector.</p>
</section>
<section id="retrieving-data" class="level2">
<h2 class="anchored" data-anchor-id="retrieving-data">Retrieving data</h2>
<p>We want to be able to see which type of databases exist on the server. We can do this with SHOW DATABASES</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>SHOW DATABASES;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Database</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">airlines</td>
</tr>
<tr class="even">
<td style="text-align: left;">citibike</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fec</td>
</tr>
<tr class="even">
<td style="text-align: left;">imdb</td>
</tr>
<tr class="odd">
<td style="text-align: left;">information_schema</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>You don’t actually need the ; at the end of the quiery above for MySQL, but for other SQL dialects you do so it doesn’t hurt.</p>
<p>We want to use the imdb databse and we have to tell our db connection that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">USE</span> imdb;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Its fine that there are 0 rows, this is just how we tell R which db we want to use.</p>
<p>Let’s look at the tables available in imdb.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>SHOW <span class="kw">TABLES</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Tables_in_imdb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">aka_name</td>
</tr>
<tr class="even">
<td style="text-align: left;">aka_title</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cast_info</td>
</tr>
<tr class="even">
<td style="text-align: left;">char_name</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comp_cast_type</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>See the kind_type table? That one shows what type of movie it is.</p>
<p>This query returns the list of kinds of “movies” stored in the IMDB. We are selecting everything with * from the kind_type table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> kind_type;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>7 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">id</th>
<th style="text-align: left;">kind</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">movie</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">tv series</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">tv movie</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">video movie</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">tv mini series</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">video game</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">episode</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Of course, you will often want to store the result of your query as a data frame. This can be achieved by setting the <code>output.var</code> argument in the chunk. Here we retrieve the list of different types of information stored in the database, save it as a data frame in R, and show the first few rows.</p>
<div class="cell" data-output.var="info_types">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>## output.var<span class="op">=</span><span class="ot">"info_types"</span> <span class="kw">in</span> this <span class="kw">chunk</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> info_type;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now have a <code>data.frame</code> called <code>info_types</code> in our environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: this is an r chunk s we use R instead of SQL.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(info_types)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id         info
1  1     runtimes
2  2   color info
3  3       genres
4  4    languages
5  5 certificates
6  6    sound mix</code></pre>
</div>
</div>
<p>That’s all you need to know about how to get data from MySQL into R. The rest of this lab consists of practicing writing SQL queries. It may be useful to reference the full <a href="http://dev.mysql.com/doc/refman/5.6/en/select.html">documentation for <code>SELECT</code> queries</a>.</p>
<p>For example, let’s say I wanted to find information on the wacky Bill Murray Movie <a href="https://www.imdb.com/title/tt0107048/">Groundhog Day</a>.</p>
<p>The titles are stored in the <code>title</code> field (i.e.&nbsp;column) in the <code>title</code> table. [Note: your professor is not responsible for naming these tables and fields!] Each row in the <code>title</code> table corresponds to a single movie, but of course, we need to restrict the rows we retrieve to only those where the <code>title</code> field equals <code>Groundhog Day</code>. The following query achieves this.</p>
<blockquote class="blockquote">
<p>Note: SQL does not require the <code>==</code> for testing equality, since you aren’t ever changing the data.</p>
</blockquote>
<blockquote class="blockquote">
<p>Note: You have to use <code>'</code> single quotes since you are working within a <code>"</code> double-quoted string.</p>
</blockquote>
<p>In the chunk below we select every column from the title-table where the title-variable equals ‘Groundhog Day’</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> title <span class="op">=</span> <span class="st">'Groundhog Day'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<colgroup>
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: left;">title</th>
<th style="text-align: left;">imdb_index</th>
<th style="text-align: right;">kind_id</th>
<th style="text-align: right;">production_year</th>
<th style="text-align: right;">imdb_id</th>
<th style="text-align: left;">phonetic_code</th>
<th style="text-align: right;">episode_of_id</th>
<th style="text-align: right;">season_nr</th>
<th style="text-align: right;">episode_nr</th>
<th style="text-align: left;">series_years</th>
<th style="text-align: left;">md5sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">19605</td>
<td style="text-align: left;">Groundhog Day</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">19602</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">a5e203197e1aa883f7884eb89e924aad</td>
</tr>
<tr class="even">
<td style="text-align: right;">27895</td>
<td style="text-align: left;">Groundhog Day</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">27822</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">48</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">74ebd1bfceb83d4bdae480326d00b493</td>
</tr>
<tr class="odd">
<td style="text-align: right;">387076</td>
<td style="text-align: left;">Groundhog Day</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2011</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">387052</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">b8d621787a0ea75c76eff6b8a6a803c1</td>
</tr>
<tr class="even">
<td style="text-align: right;">384111</td>
<td style="text-align: left;">Groundhog Day</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">384073</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">bcef9ee95ae2bb82eca4ae2341084054</td>
</tr>
<tr class="odd">
<td style="text-align: right;">337084</td>
<td style="text-align: left;">Groundhog Day</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">337080</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">fcaddb8be4ab7b9c5ca9f27bb325d869</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>That retrieved a lot of movies! Let’s see if we can refine our query. First, movies (as opposed to TV episodes, etc.) have the <code>kind_id</code> value of <code>1</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> title <span class="op">=</span> <span class="st">'Groundhog Day'</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> kind_id <span class="op">=</span> <span class="dv">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>1 records</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: left;">title</th>
<th style="text-align: left;">imdb_index</th>
<th style="text-align: right;">kind_id</th>
<th style="text-align: right;">production_year</th>
<th style="text-align: right;">imdb_id</th>
<th style="text-align: left;">phonetic_code</th>
<th style="text-align: right;">episode_of_id</th>
<th style="text-align: right;">season_nr</th>
<th style="text-align: right;">episode_nr</th>
<th style="text-align: left;">series_years</th>
<th style="text-align: left;">md5sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3664274</td>
<td style="text-align: left;">Groundhog Day</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1993</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">2f0a563d0b0a1f57a19385de5a8770e2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now we have the result that I want.</p>
<p>Imagine that I didn’t know the full title of the movie I could soften my query by searching for the phrase <code>Groundhog</code> within the title. We can do this using the <code>LIKE</code> function along with some wildcards (<code>%</code> in SQL).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> title <span class="kw">LIKE</span> <span class="st">'%Groundhog%'</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> kind_id <span class="op">=</span> <span class="dv">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>4 records</caption>
<colgroup>
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: left;">title</th>
<th style="text-align: left;">imdb_index</th>
<th style="text-align: right;">kind_id</th>
<th style="text-align: right;">production_year</th>
<th style="text-align: right;">imdb_id</th>
<th style="text-align: left;">phonetic_code</th>
<th style="text-align: right;">episode_of_id</th>
<th style="text-align: right;">season_nr</th>
<th style="text-align: right;">episode_nr</th>
<th style="text-align: left;">series_years</th>
<th style="text-align: left;">md5sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3664274</td>
<td style="text-align: left;">Groundhog Day</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1993</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">2f0a563d0b0a1f57a19385de5a8770e2</td>
</tr>
<tr class="even">
<td style="text-align: right;">3664277</td>
<td style="text-align: left;">Groundhogs</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2015</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">7b71cb8ae79de1171a71f95d2e50afd6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3664273</td>
<td style="text-align: left;">Groundhog</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">5e7183dbeb6c28fb6445c4013b2bd5d0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3664276</td>
<td style="text-align: left;">Groundhog’s Day</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">c45dd6456b9787e5f71144d6c3a2295e</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Pretend I’m still not sure which of the above four movies is the real Groundhog Day movie I’m interested in, but I’m sure its the first movie that came out. I could put them in order with the code below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> title <span class="kw">LIKE</span> <span class="st">'%Groundhog%'</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> kind_id <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> production_year;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>4 records</caption>
<colgroup>
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: left;">title</th>
<th style="text-align: left;">imdb_index</th>
<th style="text-align: right;">kind_id</th>
<th style="text-align: right;">production_year</th>
<th style="text-align: right;">imdb_id</th>
<th style="text-align: left;">phonetic_code</th>
<th style="text-align: right;">episode_of_id</th>
<th style="text-align: right;">season_nr</th>
<th style="text-align: right;">episode_nr</th>
<th style="text-align: left;">series_years</th>
<th style="text-align: left;">md5sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3664274</td>
<td style="text-align: left;">Groundhog Day</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1993</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">2f0a563d0b0a1f57a19385de5a8770e2</td>
</tr>
<tr class="even">
<td style="text-align: right;">3664277</td>
<td style="text-align: left;">Groundhogs</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2015</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">7b71cb8ae79de1171a71f95d2e50afd6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3664276</td>
<td style="text-align: left;">Groundhog’s Day</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">c45dd6456b9787e5f71144d6c3a2295e</td>
</tr>
<tr class="even">
<td style="text-align: right;">3664273</td>
<td style="text-align: left;">Groundhog</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G6532</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">5e7183dbeb6c28fb6445c4013b2bd5d0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Finally I can select just the three columns I’m interested in. Also notice that I am renaming the title table as t. So I select the columns t.title and t.production_year. This is called creating an alias. The convention is table.variable. This will be useful when joining tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t.<span class="kw">id</span>, t.title, t.production_year</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> title <span class="kw">LIKE</span> <span class="st">'%Groundhog%'</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> t.production_year;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>4 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: left;">title</th>
<th style="text-align: right;">production_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3664274</td>
<td style="text-align: left;">Groundhog Day</td>
<td style="text-align: right;">1993</td>
</tr>
<tr class="even">
<td style="text-align: right;">3664277</td>
<td style="text-align: left;">Groundhogs</td>
<td style="text-align: right;">2015</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3664276</td>
<td style="text-align: left;">Groundhog’s Day</td>
<td style="text-align: right;">2016</td>
</tr>
<tr class="even">
<td style="text-align: right;">3664273</td>
<td style="text-align: left;">Groundhog</td>
<td style="text-align: right;">2017</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Its the first Groundhog day that came out in 1993 with ID 3664274.</p>
</section>
<section id="exercise-find-the-original-ghostbusters-in-the-title-table." class="level1">
<h1>Exercise: Find the original Ghostbusters in the <code>title</code> table.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> title <span class="op">=</span> <span class="st">'Ghostbusters'</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> kind_id <span class="op">=</span> <span class="dv">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>3 records</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: left;">title</th>
<th style="text-align: left;">imdb_index</th>
<th style="text-align: right;">kind_id</th>
<th style="text-align: right;">production_year</th>
<th style="text-align: right;">imdb_id</th>
<th style="text-align: left;">phonetic_code</th>
<th style="text-align: right;">episode_of_id</th>
<th style="text-align: right;">season_nr</th>
<th style="text-align: right;">episode_nr</th>
<th style="text-align: left;">series_years</th>
<th style="text-align: left;">md5sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3644554</td>
<td style="text-align: left;">Ghostbusters</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G2312</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">9dc8686712d01fc31d597c8aa1893346</td>
</tr>
<tr class="even">
<td style="text-align: right;">3644550</td>
<td style="text-align: left;">Ghostbusters</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1984</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G2312</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">595c84db94e698e6002097cd7c2b7849</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3644556</td>
<td style="text-align: left;">Ghostbusters</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">G2312</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">d5eb40dc8725d1041e0260e7baad3cce</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now lets consider the name table</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>DESCRIBE name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Field</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Null</th>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Default</th>
<th style="text-align: left;">Extra</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;">PRI</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">auto_increment</td>
</tr>
<tr class="even">
<td style="text-align: left;">name</td>
<td style="text-align: left;">text</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;">MUL</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">imdb_index</td>
<td style="text-align: left;">varchar(12)</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">imdb_id</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">MUL</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">gender</td>
<td style="text-align: left;">varchar(1)</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="exercise-find-andie-macdowells-id-in-the-name-table." class="level1">
<h1>Exercise: Find <a href="https://www.imdb.com/title/tt0107048/fullcredits?ref_=tt_ov_st_sm">Andie MacDowell</a>’s <code>id</code> in the <code>name</code> table.</h1>
<blockquote class="blockquote">
<p>Note: that names are listed last name first and seperated by a comma (eg Murray, Bill)</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> name </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> name <span class="op">=</span> <span class="st">'MacDowell, Andie'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>1 records</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">imdb_index</th>
<th style="text-align: right;">imdb_id</th>
<th style="text-align: left;">gender</th>
<th style="text-align: left;">name_pcode_cf</th>
<th style="text-align: left;">name_pcode_nf</th>
<th style="text-align: left;">surname_pcode</th>
<th style="text-align: left;">md5sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3479179</td>
<td style="text-align: left;">MacDowell, Andie</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">M2345</td>
<td style="text-align: left;">A5352</td>
<td style="text-align: left;">M234</td>
<td style="text-align: left;">b73def7bf61212e32f9c6bd3c39e1c00</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="joining-tables" class="level2">
<h2 class="anchored" data-anchor-id="joining-tables">Joining tables</h2>
<p>In the IMDB, the <code>title</code> table contains information about movies, the <code>name</code> table contains the names of people, the <code>char_name</code> table contains information about the names of characters, and the <code>cast_info</code> table contains information about which people played which roles in which movies. Linking the tables together is essential in order to extract information from the database.</p>
<p>Since we already know that the ID of <em>Groundhog Day</em> is <code>3664274</code>, we can use that to find all of the cast assignments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cast_info</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> movie_id <span class="op">=</span> <span class="dv">3664274</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 20%">
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">person_id</th>
<th style="text-align: right;">movie_id</th>
<th style="text-align: right;">person_role_id</th>
<th style="text-align: left;">note</th>
<th style="text-align: right;">nr_order</th>
<th style="text-align: right;">role_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">118176</td>
<td style="text-align: right;">17392</td>
<td style="text-align: right;">3664274</td>
<td style="text-align: right;">376</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1764292</td>
<td style="text-align: right;">232622</td>
<td style="text-align: right;">3664274</td>
<td style="text-align: right;">352541</td>
<td style="text-align: left;">(uncredited)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2746369</td>
<td style="text-align: right;">354870</td>
<td style="text-align: right;">3664274</td>
<td style="text-align: right;">191351</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">3167452</td>
<td style="text-align: right;">400710</td>
<td style="text-align: right;">3664274</td>
<td style="text-align: right;">140101</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4584838</td>
<td style="text-align: right;">577860</td>
<td style="text-align: right;">3664274</td>
<td style="text-align: right;">98</td>
<td style="text-align: left;">(uncredited)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note that this returns a list of person-role pairs. person_id is unique for the actors and person_role_id is unique for the role played.</p>
<ol>
<li>Find all the rows in <code>cast_info</code> that correspond to Andie MacDowell as an actress.</li>
</ol>
<p>We first need to understand the columns that are in cast_info.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>DESCRIBE cast_info</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Field</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Null</th>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Default</th>
<th style="text-align: left;">Extra</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;">PRI</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">auto_increment</td>
</tr>
<tr class="even">
<td style="text-align: left;">person_id</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;">MUL</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">movie_id</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;">MUL</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">person_role_id</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">MUL</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">note</td>
<td style="text-align: left;">text</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The id from the name table should match the person_id from the cast_info table. So we can join on that. Notice that the names of the tables are being shorted again as n for name and ci for cast_info.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>##SAMPLE SOLUTION</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> n.name, ci.role_id</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cast_info <span class="kw">AS</span> ci</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> name <span class="kw">AS</span> n <span class="kw">ON</span> n.<span class="kw">id</span> <span class="op">=</span> ci.person_id</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> ci.person_id <span class="op">=</span> <span class="dv">3479179</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">role_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MacDowell, Andie</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">MacDowell, Andie</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MacDowell, Andie</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">MacDowell, Andie</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MacDowell, Andie</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="find-all-the-people-who-acted-in-groundhog-day" class="level1">
<h1>Find all the people who acted in Groundhog Day</h1>
<p>Next, we can join the <code>cast_info</code> table on the <code>name</code> table to recover the names of the actors in Groundhog Day.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> n.name, ci.role_id</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cast_info <span class="kw">AS</span> ci</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> name n <span class="kw">ON</span> n.<span class="kw">id</span> <span class="op">=</span> ci.person_id</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> movie_id <span class="op">=</span> <span class="dv">3664274</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">role_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Adler, Roger</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Blakeslee, Douglas</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Campbell, Ken Hudson</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chaiyabhat, Shaun</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DeGuide, Tony</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note how we have used table aliases to save some typing.</p>
<section id="joining-more-than-two-tables" class="level2">
<h2 class="anchored" data-anchor-id="joining-more-than-two-tables">Joining more than two tables</h2>
<p>Add the names of the characters she played to the list of Andie MacDowell ’s roles from the previous exercise.</p>
<p>We have to do a second join to get the names of the roles Andie MacDowell has played.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>## <span class="kw">SAMPLE</span> SOLUTION</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> n.name, ci.role_id, cn.name</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cast_info ci</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> name n <span class="kw">ON</span> n.<span class="kw">id</span> <span class="op">=</span> ci.person_id</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> char_name cn <span class="kw">ON</span> cn.<span class="kw">id</span> <span class="op">=</span> ci.person_role_id</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> ci.person_id <span class="op">=</span> <span class="dv">3479179</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">role_id</th>
<th style="text-align: left;">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MacDowell, Andie</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Herself</td>
</tr>
<tr class="even">
<td style="text-align: left;">MacDowell, Andie</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Herself - Presenter</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MacDowell, Andie</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Herself - audience member</td>
</tr>
<tr class="even">
<td style="text-align: left;">MacDowell, Andie</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Herself</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MacDowell, Andie</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Helen Kalahan</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="exercise-find-annie-daviss-full-filmography-in-chronological-order.-include-each-movies-title-production_year-and-the-name-of-the-character-that-she-played." class="level2">
<h2 class="anchored" data-anchor-id="exercise-find-annie-daviss-full-filmography-in-chronological-order.-include-each-movies-title-production_year-and-the-name-of-the-character-that-she-played.">Exercise Find Annie Davis’s full filmography, in chronological order. Include each movie’s <code>title</code>, <code>production_year</code>, and the name of the character that she played.</h2>
<p>Hint: You will need the cast_ing, title, and char_name tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t.title, t.production_year, cn.name</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cast_info ci</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> title t <span class="kw">ON</span> ci.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> char_name cn <span class="kw">ON</span> cn.<span class="kw">id</span> <span class="op">=</span> ci.person_role_id</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> ci.person_id <span class="op">=</span> <span class="dv">3479179</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> production_year;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<colgroup>
<col style="width: 58%">
<col style="width: 18%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: right;">production_year</th>
<th style="text-align: left;">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Greystoke: The Legend of Tarzan, Lord of the Apes</td>
<td style="text-align: right;">1984</td>
<td style="text-align: left;">Miss Jane Porter</td>
</tr>
<tr class="even">
<td style="text-align: left;">St.&nbsp;Elmo’s Fire</td>
<td style="text-align: right;">1985</td>
<td style="text-align: left;">Dale Biberman</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex, Lies, and Videotape</td>
<td style="text-align: right;">1989</td>
<td style="text-align: left;">Ann Bishop Mullany</td>
</tr>
<tr class="even">
<td style="text-align: left;">Green Card</td>
<td style="text-align: right;">1990</td>
<td style="text-align: left;">BrontÃ«</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Object of Beauty</td>
<td style="text-align: right;">1991</td>
<td style="text-align: left;">Tina</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="exercise-pull-up-the-titles-of-the-movies-that-were-made-in-my-birth-year-1984.-there-are-more-than-1000-so-well-put-a-limit-on-the-number-of-movies-returned." class="level1">
<h1>Exercise pull up the titles of the movies that were made in my birth year 1984. There are more than 1000 so we’ll put a limit on the number of movies returned.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t.title, t.production_year</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> production_year <span class="op">=</span> <span class="dv">1984</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">100</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: right;">production_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(1984-11-04)</td>
<td style="text-align: right;">1984</td>
</tr>
<tr class="even">
<td style="text-align: left;">Game 2</td>
<td style="text-align: right;">1984</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(#1.1)</td>
<td style="text-align: right;">1984</td>
</tr>
<tr class="even">
<td style="text-align: left;">A Winter Harvest</td>
<td style="text-align: right;">1984</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Once a Hero</td>
<td style="text-align: right;">1984</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="exercise-pull-the-one-movie-that-andie-macdowell-was-in-in-1984-and-bring-it-into-r-as-a-dataframe.-hint-we-found-it-above." class="level1">
<h1>Exercise pull the one movie that Andie MacDowell was in in 1984 and bring it into R as a dataframe. Hint: We found it above.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t.title, t.production_year</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cast_info <span class="kw">AS</span> ci</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> title <span class="kw">AS</span> t <span class="kw">ON</span> ci.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">1984</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> ci.person_id <span class="op">=</span> <span class="dv">3479179</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: right;">production_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Greystoke: The Legend of Tarzan, Lord of the Apes</td>
<td style="text-align: right;">1984</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="exercise" class="level1">
<h1>Exercise</h1>
<p>This <a href="https://www.imdb.com/list/ls000011405/">website</a> lists Nicole Kidman as the most prolific actress. Find the name and production year of all of the movies she has been in ordered by production_year descending</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> name </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> name <span class="op">=</span> <span class="st">'Kidman, Nicole'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>1 records</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">imdb_index</th>
<th style="text-align: right;">imdb_id</th>
<th style="text-align: left;">gender</th>
<th style="text-align: left;">name_pcode_cf</th>
<th style="text-align: left;">name_pcode_nf</th>
<th style="text-align: left;">surname_pcode</th>
<th style="text-align: left;">md5sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3353717</td>
<td style="text-align: left;">Kidman, Nicole</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">f</td>
<td style="text-align: left;">K3524</td>
<td style="text-align: left;">N2423</td>
<td style="text-align: left;">K35</td>
<td style="text-align: left;">69a5531f1e2c7311fcd6c17f1124b397</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t.title, t.production_year</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cast_info <span class="kw">AS</span> ci</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> title <span class="kw">AS</span> t <span class="kw">ON</span> ci.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> ci.person_id <span class="op">=</span> <span class="dv">3353717</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span>  t.production_year <span class="kw">DESC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: right;">production_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Destroyer</td>
<td style="text-align: right;">2018</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aquaman</td>
<td style="text-align: right;">2018</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Boy Erased</td>
<td style="text-align: right;">2018</td>
</tr>
<tr class="even">
<td style="text-align: left;">How to Talk to Girls at Parties</td>
<td style="text-align: right;">2017</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Upside</td>
<td style="text-align: right;">2017</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="exercise-1" class="level1">
<h1>Exercise</h1>
<p>Challenge: Look up the COUNT() and GROUP function for MySQL to answer the question, which year did Nicole Kidman act in the most movies?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  t.production_year, <span class="fu">COUNT</span>(t.production_year) <span class="kw">AS</span> movies</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cast_info <span class="kw">AS</span> ci</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> title <span class="kw">AS</span> t <span class="kw">ON</span> ci.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> ci.person_id <span class="op">=</span> <span class="dv">3353717</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> t.production_year</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> movies <span class="kw">DESC</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 5</caption>
<thead>
<tr class="header">
<th style="text-align: right;">production_year</th>
<th style="text-align: right;">movies</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2007</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2015</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2017</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2006</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../credits.qmd">credits</a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>